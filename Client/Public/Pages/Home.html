<br>
<h3>At Smiles.com we share our positive feelings.</h3>
<br>
<h3>Sign up now and post what ever made you happy today,</h3>
<h3>to see more smile posts, and to use our chatrooms!</h3>
<br>
<br>
<br>

<div id="postsPos">
    <div id="posts">
    </div>

</div>

<p id="response"></p>

<script>

    const postsDiv = document.getElementById("posts");
    let posts;


    //Global metode som vi kan bruge til vi implemintere JS filer

    setActive()
    function setActive(){
        let currentPage = window.location.pathname
        let aTags = document.getElementsByTagName('a')
        for (let i = 0; i < 2; i++) {
            if(aTags[i].className === "active"){
                aTags[i].id === aTags[i].className
            }
        }
        if(currentPage === "/") {
            currentPage = "home"
        }
        document.getElementById(currentPage).className = "active"
    }

    async function loadPosts(){
        const response = await fetch("/api/posts");
        const result = await response.json();
        posts = result;
        postsDiv.innerHTML = ""; 
        for(let i in posts){
            const {id, text, userId, date, hours, minutes, categori} = posts[i];

            if(categori == 'home') {
                const res = await fetch(`/api/getUsername/${userId}`);
                const foundUsername = await res.text();
                postsDiv.innerHTML += ` <br> 
                <article class="postArticle">
                    <b id="username">${foundUsername}</b>
                    <br>
                    <span id="text${id}">${text}</span>
                    <br>
                    <br>
                    <b id="date"> ${date} </b> <b id="time"> ${hours}:${minutes}</b>
                    <br>
                </article> 
            <br>`;
            
            }
        }
    }

    loadPosts();

</script>